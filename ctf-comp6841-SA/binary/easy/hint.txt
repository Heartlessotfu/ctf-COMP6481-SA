gets instead of fgets this looks like a buffer overflow....